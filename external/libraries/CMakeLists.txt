#Build libraries given by CmakeData
#Create CMakeData that looks like set ( LIBRARIES lib1 lib2 ...)
if(EXISTS "${CMAKE_CURRENT_LIST_DIR}/CMakeData.txt")
include("CMakeData.txt")
endif()

if(COMPILE_AT_FIRST)
        foreach (dec ${COMPILE_AT_FIRST})
                message ("Adding lib at first ${dec}" )
                add_subdirectory ( ${dec} )
        endforeach()
set(N_LIBRARIES ${COMPILE_AT_FIRST} ${N_LIBRARIES})
endif()

#only compile given libraries
if (LIBRARIES)
        foreach (dec ${LIBRARIES})
                message ("Adding runtime_module ${dec}" )
                add_subdirectory ( ${dec} )
        endforeach()
else()
#get all libraries and compile them if permitted
    SUBDIRLIST(SUBDIRS ${CMAKE_CURRENT_LIST_DIR})
    foreach (dec ${SUBDIRS})
        if (N_LIBRARIES AND ";${N_LIBRARIES};" MATCHES "${dec}")
        else()
            add_subdirectory(${dec})
        endif()
    endforeach()
endif()
